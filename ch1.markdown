# 界面组成及文件浏览

## 界面组成

双击桌面或者开始菜单中的Directory Opus快捷方式，第一次运行DOpus会弹出以下窗口，你可以勾选「不要再显示开始窗口」，以后启动DOpus这个窗口就不会弹出了。

然后DOpus的窗口（List[^1]）就会打开，你可以在里面进行各种文件操作，基本操作和快捷键与Windows自带的资源管理器都是一样的。



如上图所示，可以将窗口划分为几个部分：

1. 标题栏：显示标题及最小化、最大化、关闭按钮。

2. 地址栏：显示当前路径、搜索框、前进后退向上按钮等。

3. 菜单栏：左边是文件、编辑、工具和设置共四个下拉式菜单，右边依次是是缩略图切换、文件夹选项、双栏开关、查看器窗格开关及帮助共六个按钮。

4. 操作栏：包括了常用的文件操作按钮。

5. 文件夹树：同资源管理器中的文件夹树。

6. 文件显示栏：显示当前文件夹中的文件列表，可以双栏（左右/上下）也可以单栏显示。每一个文件显示栏都支持标签式浏览。

7. 状态栏：显示当前文件夹的状态，包括总文件数目、隐藏文件数等。


对于地址栏、菜单栏和操作栏来说，里面的按钮和命令都是可以自行定制的，他们的位置也是可以调整的。

窗口还可以更复杂，如下图（我调整了地址栏、菜单栏和操作栏的位置，去调了搜索功能，符合我的操作习惯）。文件显示栏被改为上下双栏，文件夹树也显示了两个，分别对应两个文件显示栏。


图 3 2与图 3 1相比，还多出了以下几个部分：
8.	工具面板：在使用同步文件、查找文件和查找重复文件功能时，会打开工具面板。
9.	查看器窗格：在查看器窗格中可以快速预览已识别的文件，如图片、音乐、Office文档等。查看器窗格的上方有一些简单的操作按钮，如旋转放大等。
10.	元数据窗格：可以显示文件的元数据（属性），比如对于相片文件来说可以显示分辨率、颜色空间、相机型号等，对于可以编辑的元数据（属性）可以在此进行编辑。

对于文件显示栏、文件夹树、工具面板、查看器窗格、元数据窗格来说，点击右上角的X可以直接关闭，此外双栏显示、文件夹树、查看器窗格和元数据窗格可以通过快捷键打开/关闭：

| 快捷键  | 行为        |
| ---- | --------- |
| F6   | 打开/关闭双栏显示 |
| F7   | 打开/关闭文件夹树 |
| F8   | 打开/关闭查看器  |
| F9   | 打开/关闭元数据  |

## 资源管理器替代


在「菜单栏-设置-选项-DOpus启动-资源管理器替代」中可以设置DOpus对资源管理器的替代程度：
 
有四个选项：
1.	不替代资源管理器：选择这个选项后，所有文件夹的「打开」操作调用系统自带的资源管理器打开文件夹并查看其内容。
2.	对所有常规文件夹替换资源管理器：选择这个选项后，使用DOpus完成常规文件夹的「打开」操作，非常规文件夹（如控制面板、回收站）的「打开」操作则依然调用系统自带的资源管理器。
3.	对所有文件夹替换资源管理器：选择这个选项后，使用DOpus完成所有文件夹的「打开」操作。
4.	对除下列文件夹意外的所有文件夹替换资源管理器：选择这个选项后，对下列文件夹以外的文件夹，使用DOpus完成「打开」操作，而下列文件夹依然使用资源管理器打开。
一般情况，建议选择第2项「对所有常规文件夹替换资源管理器」，这也是在初始化向导中的设置。

## DOpus启动方式


双击DOpus的快捷方式后，默认设置下会启动两个进程——dopus.exe和dopusrt.exe，可以在Windows的任务管理器里面看到。

这两个进程中的dopus.exe是DOpus的主进程，该进程运行之后，右下角系统托盘里面就会有DOpus的图标，表明DOpus已经启动了后台进程，随时可以开启一个窗口。建议保持dopus.exe在后台运行。这样的话打开窗口的速度比较快，而且可以使用浮动工具栏以及全局快捷键功能。
 
之前初始化向导中的「系统启动时自动运行」选项也是指的是在开机是运行dopus.exe进程。

而dopusrt.exe这个进程则是为了监听各种事件（双击、资源管理器替代）而运行的，有了这个进程，才可以完成相应的事件。

DOpus可以设置多种启动方式：
1.	通过快捷方式。
2.	在桌面任何空白区域双击。
3.	双击系统托盘中的DOpus图标。
4.	将DOpus固定到任务栏，通过任务栏启动。
5.	如果替代了资源管理器，打开常规文件夹。
6.	如果替代了资源管理器，用快捷键Win+E可以启动并打开「计算机」。
7.	如果替代了资源管理器，并且dopus.exe进程在运行的话，Win+Shift+E可以启动一个新的DOpus窗口。
各种启动方式所需条件见下表：

| 启动方式  | 所需条件        |
| ---- | --------- |
| 快捷方式 | 无 |
| 双击桌面空白区域   | dopusrt.exe进程+设置中允许 |
| 双击系统托盘   | 设置中允许  |
| 通过任务栏   | 无  |
| 打开常规文件夹| 替代资源管理器|
| Win+E|替代资源管理器|
| Win+Shift+E|替代资源管理器+dopus.exe进程|


## 让Win+E不打开「计算机」


有些用户习惯了使用Win+E打开资源管理器，但是在Windows的默认设置里面Win+E就是打开「计算机」这个路径，在DOpus中稍作修改，就可以让Win+E和双击桌面空白区域的效果一样，也就是「激活最近活动的窗口（若无，则打开默认窗口）」。

设置方法如下：
1.	在「设置-自定义工具栏-快捷键」中，添加一个快捷键：
 
2.	在弹出的命令编辑器中，勾选「全局快捷键」，然后在「快捷键」一栏，按Win+E，然后在函数一栏，填写「Go current」，确定。
 
这样设置之后，在dopus.exe启动的情况下，Win+E就是打开或者激活已有的窗口，而不是打开「计算机」了。在快捷键列表里面你会发现有Win+Shift+E，看看它的命令是什么？

## 避免打开多个DOpus窗口


针对表 11 1中的各种启动方式，设置方法如下：
1.	快捷方式：如果运行任何地方的快捷方式，则一定会打开一个新的DOpus窗口，所以此种启动方法无法实现单窗口。
2.	双击桌面空白区域：在「设置-选项-DOpus启动-从桌面-在桌面上双击」里，选择「激活最近活动的窗口（若无，则打开默认窗口）」。
3.	双击系统托盘：在「设置-选项-DOpus启动-从任务栏图标-在任务栏图标上双击」里，选择「激活最近活动的窗口（若无，则打开默认窗口）」。
4.	任务栏启动：和快捷方式相同，如果使用鼠标中键点击任务栏上的图标，则一定会新开一个DOpus窗口，此种方法无法实现单窗口。
5.	打开常规文件夹：在「设置-选项-DOpus启动-资源管理器替代」中，勾选「在新标签中打开外部文件夹」，这样的话如果已经有了一个DOpus的窗口，再在桌面或者资源管理器中打开文件夹的话，会在DOpus已有的窗口内新开一个标签打开。「在打开一个新窗口时展开所有默认的窗口标签」也建议勾选。
6.	Win+E：和打开常规文件夹相同。
7.	Win+Shift+E：这个命令本来就是要新打开一个DOpus窗口，因此不适用。

因此，要实现DOpus的单窗口运行，需要设置的就是：
	「设置-选项-DOpus启动-从桌面-在桌面上双击」里，选择「激活最近活动的窗口（若无，则打开默认窗口）」
	「设置-选项-DOpus启动-从任务栏图标-在任务栏图标上双击」里，选择「激活最近活动的窗口（若无，则打开默认窗口）」
	「设置-选项-DOpus启动-资源管理器替代」中，勾选「在新标签中打开外部文件夹」和「在打开一个新窗口时展开所有默认的窗口标签」
并避免通过快捷方式、中键点击任务栏图标以及Win+Shift+E方式启动DOpus。

如果你想要的并不是单窗口而是多窗口的话，也请依照上面的顺序进行检查并取消勾选。
