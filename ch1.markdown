# 界面组成及文件浏览

## 界面组成

双击桌面或者开始菜单中的Directory Opus快捷方式，第一次运行DOpus会弹出以下窗口，你可以勾选「不要再显示开始窗口」，以后启动DOpus这个窗口就不会弹出了。

然后DOpus的窗口（List[^1]）就会打开，你可以在里面进行各种文件操作，基本操作和快捷键与Windows自带的资源管理器都是一样的。



如上图所示，可以将窗口划分为几个部分：

1. 标题栏：显示标题及最小化、最大化、关闭按钮。

2. 地址栏：显示当前路径、搜索框、前进后退向上按钮等。

3. 菜单栏：左边是文件、编辑、工具和设置共四个下拉式菜单，右边依次是是缩略图切换、文件夹选项、双栏开关、查看器窗格开关及帮助共六个按钮。

4. 操作栏：包括了常用的文件操作按钮。

5. 文件夹树：同资源管理器中的文件夹树。

6. 文件显示栏：显示当前文件夹中的文件列表，可以双栏（左右/上下）也可以单栏显示。每一个文件显示栏都支持标签式浏览。

7. 状态栏：显示当前文件夹的状态，包括总文件数目、隐藏文件数等。


对于地址栏、菜单栏和操作栏来说，里面的按钮和命令都是可以自行定制的，他们的位置也是可以调整的。

窗口还可以更复杂，如下图（我调整了地址栏、菜单栏和操作栏的位置，去调了搜索功能，符合我的操作习惯）。文件显示栏被改为上下双栏，文件夹树也显示了两个，分别对应两个文件显示栏。


图 3 2与图 3 1相比，还多出了以下几个部分：
8.	工具面板：在使用同步文件、查找文件和查找重复文件功能时，会打开工具面板。
9.	查看器窗格：在查看器窗格中可以快速预览已识别的文件，如图片、音乐、Office文档等。查看器窗格的上方有一些简单的操作按钮，如旋转放大等。
10.	元数据窗格：可以显示文件的元数据（属性），比如对于相片文件来说可以显示分辨率、颜色空间、相机型号等，对于可以编辑的元数据（属性）可以在此进行编辑。

对于文件显示栏、文件夹树、工具面板、查看器窗格、元数据窗格来说，点击右上角的X可以直接关闭，此外双栏显示、文件夹树、查看器窗格和元数据窗格可以通过快捷键打开/关闭：

| 快捷键  | 行为        |
| ---- | --------- |
| F6   | 打开/关闭双栏显示 |
| F7   | 打开/关闭文件夹树 |
| F8   | 打开/关闭查看器  |
| F9   | 打开/关闭元数据  |

## 资源管理器替代


在「菜单栏-设置-选项-DOpus启动-资源管理器替代」中可以设置DOpus对资源管理器的替代程度：
 
有四个选项：
1.	不替代资源管理器：选择这个选项后，所有文件夹的「打开」操作调用系统自带的资源管理器打开文件夹并查看其内容。
2.	对所有常规文件夹替换资源管理器：选择这个选项后，使用DOpus完成常规文件夹的「打开」操作，非常规文件夹（如控制面板、回收站）的「打开」操作则依然调用系统自带的资源管理器。
3.	对所有文件夹替换资源管理器：选择这个选项后，使用DOpus完成所有文件夹的「打开」操作。
4.	对除下列文件夹意外的所有文件夹替换资源管理器：选择这个选项后，对下列文件夹以外的文件夹，使用DOpus完成「打开」操作，而下列文件夹依然使用资源管理器打开。
一般情况，建议选择第2项「对所有常规文件夹替换资源管理器」，这也是在初始化向导中的设置。

## DOpus启动方式


双击DOpus的快捷方式后，默认设置下会启动两个进程——dopus.exe和dopusrt.exe，可以在Windows的任务管理器里面看到。

这两个进程中的dopus.exe是DOpus的主进程，该进程运行之后，右下角系统托盘里面就会有DOpus的图标，表明DOpus已经启动了后台进程，随时可以开启一个窗口。建议保持dopus.exe在后台运行。这样的话打开窗口的速度比较快，而且可以使用浮动工具栏以及全局快捷键功能。
 
之前初始化向导中的「系统启动时自动运行」选项也是指的是在开机是运行dopus.exe进程。

而dopusrt.exe这个进程则是为了监听各种事件（双击、资源管理器替代）而运行的，有了这个进程，才可以完成相应的事件。

DOpus可以设置多种启动方式：
1.	通过快捷方式。
2.	在桌面任何空白区域双击。
3.	双击系统托盘中的DOpus图标。
4.	将DOpus固定到任务栏，通过任务栏启动。
5.	如果替代了资源管理器，打开常规文件夹。
6.	如果替代了资源管理器，用快捷键Win+E可以启动并打开「计算机」。
7.	如果替代了资源管理器，并且dopus.exe进程在运行的话，Win+Shift+E可以启动一个新的DOpus窗口。
各种启动方式所需条件见下表：

| 启动方式  | 所需条件        |
| ---- | --------- |
| 快捷方式 | 无 |
| 双击桌面空白区域   | dopusrt.exe进程+设置中允许 |
| 双击系统托盘   | 设置中允许  |
| 通过任务栏   | 无  |
| 打开常规文件夹| 替代资源管理器|
| Win+E|替代资源管理器|
| Win+Shift+E|替代资源管理器+dopus.exe进程|


## 让Win+E不打开「计算机」


有些用户习惯了使用Win+E打开资源管理器，但是在Windows的默认设置里面Win+E就是打开「计算机」这个路径，在DOpus中稍作修改，就可以让Win+E和双击桌面空白区域的效果一样，也就是「激活最近活动的窗口（若无，则打开默认窗口）」。

设置方法如下：
1.	在「设置-自定义工具栏-快捷键」中，添加一个快捷键：
 
2.	在弹出的命令编辑器中，勾选「全局快捷键」，然后在「快捷键」一栏，按Win+E，然后在函数一栏，填写「Go current」，确定。
 
这样设置之后，在dopus.exe启动的情况下，Win+E就是打开或者激活已有的窗口，而不是打开「计算机」了。在快捷键列表里面你会发现有Win+Shift+E，看看它的命令是什么？

## 避免打开多个DOpus窗口


针对表 11 1中的各种启动方式，设置方法如下：
1.	快捷方式：如果运行任何地方的快捷方式，则一定会打开一个新的DOpus窗口，所以此种启动方法无法实现单窗口。
2.	双击桌面空白区域：在「设置-选项-DOpus启动-从桌面-在桌面上双击」里，选择「激活最近活动的窗口（若无，则打开默认窗口）」。
3.	双击系统托盘：在「设置-选项-DOpus启动-从任务栏图标-在任务栏图标上双击」里，选择「激活最近活动的窗口（若无，则打开默认窗口）」。
4.	任务栏启动：和快捷方式相同，如果使用鼠标中键点击任务栏上的图标，则一定会新开一个DOpus窗口，此种方法无法实现单窗口。
5.	打开常规文件夹：在「设置-选项-DOpus启动-资源管理器替代」中，勾选「在新标签中打开外部文件夹」，这样的话如果已经有了一个DOpus的窗口，再在桌面或者资源管理器中打开文件夹的话，会在DOpus已有的窗口内新开一个标签打开。「在打开一个新窗口时展开所有默认的窗口标签」也建议勾选。
6.	Win+E：和打开常规文件夹相同。
7.	Win+Shift+E：这个命令本来就是要新打开一个DOpus窗口，因此不适用。

因此，要实现DOpus的单窗口运行，需要设置的就是：
	「设置-选项-DOpus启动-从桌面-在桌面上双击」里，选择「激活最近活动的窗口（若无，则打开默认窗口）」
	「设置-选项-DOpus启动-从任务栏图标-在任务栏图标上双击」里，选择「激活最近活动的窗口（若无，则打开默认窗口）」
	「设置-选项-DOpus启动-资源管理器替代」中，勾选「在新标签中打开外部文件夹」和「在打开一个新窗口时展开所有默认的窗口标签」
并避免通过快捷方式、中键点击任务栏图标以及Win+Shift+E方式启动DOpus。

如果你想要的并不是单窗口而是多窗口的话，也请依照上面的顺序进行检查并取消勾选。

## 基本文件浏览


本节将介绍在DOpus窗口中浏览文件夹的基本概念和各种方法。如果单就浏览文件夹中的内容来说，DOpus和Windows自带的资源管理器并没有什么不同，各种快捷键也都一样。

DOpus支持双栏浏览，即每一个窗口可以包括一个或两个文件显示栏。DOpus也支持多标签浏览，每个文件显示栏里面可以有若干标签页，每个标签页里面显示一个文件夹内的内容。

DOpus还提供了各种贴心的功能，让你能快速定位到自己的常用文件夹，也可以根据条件对文件夹中的内容进行着色（比如昨天更改过的文件标记为红色）等。

### 查看模式

和Windows的资源管理器一样，DOpus也提供了多个查看模式：
	
- 大图标：同资源管理器，按字母顺序用大图标罗列文件夹中的文件名，一般是32×32的图标。

- 小图标：同资源管理器，按字母顺序用小图标罗列文件夹中的文件名，一般是16×16的图标。

- 列表：同资源管理器，按字母顺序用小图标竖直罗列文件夹中的文件名。

- 	详情：用表格的方式列出文件夹中的文件及指定属性，表头称为属性栏。每个文件占一行，每一属性（字段）占一列。Ctrl+鼠标滚轮可以改变字体大小。

- 	加强模式：和详情模式外观相同，但是对鼠标键盘的交互可以更详细的设置。默认设置下加强模式的鼠标左键单击选择不会对已选择文件取消选择，点击空白处也不会取消选择。在「选项-窗口模式-加强模式」中可以对其进行详细设置。Ctrl+鼠标滚轮可以改变字体大小。
   
- 	缩略图：同资源管理器，Ctrl+鼠标滚轮可以改变缩略图大小。

- 	平铺：平铺模式以大图标显示文件和文件夹。这种图标比“大图标”模式的要大，并且将相关信息显示在文件或文件夹名下面，显示信息可在文件类型中设置。
  

各种查看模式可以通过右键菜单或者工具栏上的按钮来切换：

在详情模式和加强模式中，可以修改当前显示的列属性。操作十分简单，只需要在属性栏上右击鼠标，就可以对属性栏进行修改，已经有的属性可以取消，也可以选择「属性栏」后新增属性。

### 双栏浏览

在每个DOpus的窗口中，可以同时有最多两个文件显示栏。两个文件显示栏可以左右并排，也可以上下排列，如下图所示：

1.	标题栏，显示当前文件夹的路径，右边有若干按钮。

2.	文件列表：显示当前文件夹中的内容。

3.	标签栏：在不同的标签可以打开不同的文件夹，进行不同的操作，各标签之间的查看模式可以不同。


在双栏时，标题栏中的按钮和单栏略有不同，将各按钮的功能总结如下：
	 ：后退、前进和向上。
	 ：在右栏中显示左栏的内容。
	 ：在左栏中显示右栏内容。
	 ：在下栏中显示上栏内容。
	 ：在上栏中显示下栏内容。
	 ：交换左右两个文件显示栏的内容，交换包括标签栏。
	 ：交换上下两个文件显示栏的内容，交换包括标签栏。
	 ：关闭标签，如果是唯一标签的话关闭文件显示栏。


可以看到在图 4 4中，左右（上下）栏的标题栏颜色是不同的。实际上在默认设置下文件显示栏的标题栏会有三种颜色，其区别在于执行操作时，文件的流向不同：
 
-第一种颜色表明该文件显示栏处于「来源」状态。

-	第二种颜色表明该文件显示栏处于「目标」状态。

-	第三种颜色表明该文件显示栏处于「关闭」状态，文件操作与该文件显示栏无关。


通过鼠标的点击激活，文件显示栏会在前两种状态之间切换。「关闭」状态的文件显示栏需要三个及以上的单栏窗口才会出现。通过Tab键也可以切换选中的文件显示栏，不过根据「选项-窗口-选项-用Tab键在双窗口中切换‘来源/目标’」，这一操作有两种情况：
1.	如果未勾选，按Tab键，焦点在两个文件显示栏和地址栏之间轮流切换。
2.	如果勾选，按Tab键，焦点只在两个文件显示栏之间切换。

例如，在图 4 4中，如果在左（上）的文件显示栏内选择了C盘内的dell文件夹，然后点击操作栏内的「复制文件」或者使用快捷键Ctrl+1，则dell文件夹就会自动的复制到C:\inetpub\history\CFGHISTORY_0000000022 这个文件夹里面，并不需要用鼠标在左右（上下）两栏之间分别复制和粘贴，或者拖拽。使用两个单文件显示栏的DOpus窗口，操作的结果也是一样的。

###　C-A-S 打开文件夹

默认设置下DOpus「打开文件夹」的几种不同的操作方式（以后略称为C-A-S）：

| 快捷键  | 行为        |
| ---- | --------- |
| 双击或回车| 在当前标签页中打开文件夹  |
| Ctrl+双击或回车   | 在另一栏打开文件夹 |
| Alt+双击   | 在新标签页中打开文件夹  |
| Shift+双击   | 在新窗口中打开文件夹  |

需要注意的是，Alt+回车和Shift+回车在默认设置下和对应的双击操作效果不同，分别是「查看属性」和「打开跳转模式」。


### 浏览导航

在DOpus默认设置下，有两组按钮可以实现「向上、前进和后退」
1.	地址栏中的三个按钮： ，分别是后退、前进和向上
2.	文件显示栏顶部按钮： ，前三个分别是后退、前进和向上。
这两组按钮的单击功能基本相同，不同之处在于：
1.	地址栏中的按钮右边有下拉菜单：前进和后退按钮的下拉菜单就是历史清单，向上按钮的下拉菜单除了包括历史清单，还有一些常用地址：
  
2.	文件显示栏标题栏中的三个按钮支持C-A-S，但地址栏中的不支持。

有些键盘上有前进和后退的功能键，按下之后实现相同的效果。

另外，勾选「首选项-文件夹-文件夹显示」中的「文件夹中显示’..’上级图标」，可以在文件列表中添加一个「..」上一级图标，点击它也可以返回上一级（支持C-A-S）：

向上、前进和后退相关快捷键有：

| 快捷键  | 行为        |
| ---- | --------- |
| Alt+左方向键| 后退  |
| Alt+右方向键   | 前进 |
| Backspace   | 向上  |
| Ctrl+Backspace   | 向上到根目录  |

### 文件夹树

默认设置下，按F8开关文件夹树。有文件夹树，可以一目了然的看到当前文件在整个文件系统中的位置。文件夹树的位置一般在文件显示栏的左边。


可以在文件夹树中进行的有：
	对文件夹的普通操作。
	在文件系统中快速定位和打开文件夹，在文件显示栏中打开的文件夹会在文件夹树中展开，并显示为选中状态。
	显示子文件夹，点击文件夹左边的 可以展开查看或收起该文件夹内的子文件夹。
	和文件显示栏中相同的文件夹右键菜单。
	在文件夹树的文件夹间拖拽文件。

文件夹树标题栏右边有三个按钮，功能分别为：
	 「定位到当前文件夹」：如果因为上下滚动或者文件夹的打开/收起，让当前选择的文件夹不在文件夹树的显示范围之内，按这个按钮就可以把当前选择的文件夹位置设定在文件夹树的竖直中央。
	 「锁定文件夹树，不随文件显示栏改变」：如果点击这个按钮，让它变成锁定的状态 ，文件夹树的状态（包括选定、展开、收起状态）都不会随着文件显示栏中的操作而变化。
	 「关闭文件夹树」：同F8。

在「首选项-文件夹树-外观」中，可以勾选「高亮显示所选文件夹的路径」，这样在文件夹树中就可以直观的看到当前打开文件夹在整个文件系统中的相对位置：

文件夹树相关的快捷键有：

### 地址栏

### 状态栏

### 多标签页浏览

#### 标签页基本操作

#### 链接标签页

#### 锁定标签页

#### 标签页群组

## 界面样式

DOpus程序内置了8种界面样式（Style）分别是：「常规双栏」「水平双栏」「垂直双栏」「资源管理器」「幻灯片」「图像」「元数据」和「单窗口」

[^1]: Lister这个词，按照官方的说法，是沿袭了1990年给Amiga开发文件管理器时使用的术语。原文为 What do you call something that lists things? A lister!
